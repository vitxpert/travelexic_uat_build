"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5181],{5181:(C,p,s)=>{s.r(p),s.d(p,{FeedbackPageModule:()=>I});var u=s(6895),c=s(4006),a=s(8058),_=s(3317),e=s(8256),b=s(1692),f=s(5146),m=s(3646);function h(n,r){1&n&&(e.ynx(0),e.TgZ(1,"ion-item"),e._UZ(2,"ion-textarea",14),e.qZA(),e.BQk())}function v(n,r){1&n&&(e.ynx(0),e._UZ(1,"ion-range",15),e.TgZ(2,"ion-row",16)(3,"ion-col",17),e._uU(4," \xa0 "),e.qZA(),e.TgZ(5,"ion-col",18),e._uU(6,"1"),e.qZA(),e.TgZ(7,"ion-col",18),e._uU(8,"2"),e.qZA(),e.TgZ(9,"ion-col",18),e._uU(10,"3"),e.qZA(),e.TgZ(11,"ion-col",18),e._uU(12,"4"),e.qZA(),e.TgZ(13,"ion-col",18),e._uU(14,"5"),e.qZA()(),e.BQk()),2&n&&(e.xp6(1),e.Q6J("ticks",!0)("snaps",!0)("min",0)("max",5))}function x(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"div",21),e._UZ(2,"ion-radio",22),e._uU(3),e.qZA(),e.BQk()),2&n){const t=r.$implicit,o=e.oxw(5);e.xp6(2),e.Q6J("value",o.showOptions(t)),e.xp6(1),e.hij(" ",o.showOptions(t)," ")}}function k(n,r){if(1&n&&(e.ynx(0),e.TgZ(1,"ion-radio-group",19),e.YNc(2,x,4,2,"ng-container",20),e.qZA(),e.BQk()),2&n){const t=e.oxw().index,o=e.oxw(3);e.xp6(2),e.Q6J("ngForOf",o.getOptions(t).controls)}}function F(n,r){if(1&n&&(e.TgZ(0,"ion-card",11)(1,"ion-card-content",12)(2,"div",13)(3,"ion-label"),e._uU(4),e.qZA()(),e.YNc(5,h,3,0,"ng-container",5),e.YNc(6,v,15,4,"ng-container",5),e.YNc(7,k,3,1,"ng-container",5),e.qZA()()),2&n){const t=r.$implicit,o=r.index,i=e.oxw(3);e.xp6(1),e.Q6J("formGroupName",o),e.xp6(3),e.Oqu(i.showItem(t)),e.xp6(1),e.Q6J("ngIf","text"==i.getType(t)),e.xp6(1),e.Q6J("ngIf","rating"==i.getType(t)),e.xp6(1),e.Q6J("ngIf","radio"==i.getType(t))}}function P(n,r){if(1&n&&(e.ynx(0),e.YNc(1,F,8,5,"ion-card",8),e.TgZ(2,"div",9)(3,"ion-button",10),e._uU(4,"Submit"),e.qZA()(),e._UZ(5,"br")(6,"br")(7,"br")(8,"br"),e.BQk()),2&n){const t=e.oxw(2);e.xp6(1),e.Q6J("ngForOf",t.questionForm().controls)}}function q(n,r){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",23),e._UZ(2,"img",24),e.TgZ(3,"ion-button",25),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.updateFeedback())}),e._uU(4,"Update Feedback"),e.qZA()(),e.BQk()}}function Z(n,r){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"form",7),e.NdJ("ngSubmit",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.onSubmit())}),e.YNc(2,P,9,1,"ng-container",5),e.YNc(3,q,5,0,"ng-container",5),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.questions),e.xp6(1),e.Q6J("ngIf",t.form_submitted),e.xp6(1),e.Q6J("ngIf",!t.form_submitted)}}function w(n,r){1&n&&(e.TgZ(0,"div",9)(1,"ion-card"),e._UZ(2,"img",26),e.qZA()())}const O=[{path:"",component:(()=>{class n{constructor(t,o,i,g){this.location=t,this.globalService=o,this.fb=i,this.apiService=g,this.review_id="",this.form_submitted=!1,this.feedback=!1,this.isAPILoading=!1,this.ques=new c.Oe([]),this.loadFeedback(),this.loadInitialData()}ngOnInit(){this.globalService.groupSwitchEvent.subscribe(t=>{null!==t&&(this.questions.reset(),this.loadFeedback())}),this.questions=new c.cw({question:new c.Oe([])})}loadInitialData(){const t=JSON.parse(localStorage.getItem("user"))||"";this.actionGroup=localStorage.getItem("cc_selected_group_id"),t.forEach((o,i)=>{o.order_id===Number(this.actionGroup)&&(this.review_id=t[i].booking_id)})}loadFeedback(){this.isAPILoading=!0;const t=new FormData;t.append("booking_id",localStorage.getItem("cc_selected_group_id")),t.append("auth",localStorage.getItem("ca_auth_key")),this.apiService.fetchFeedbackQuestions(t).subscribe(o=>{"fail"==o?.status?(this.isAPILoading=!1,this.feedback=!1):(this.isAPILoading=!1,this.feedback=!0,""==o.question[o.question.length-1].ans&&(this.form_submitted=!0),o.question.forEach((i,g)=>{this.ques=this.questions.get("question"),this.ques.push(this.createQuestion(i)),i.options.forEach(l=>{this.getOptions(g).push(this.createOption(l.key))})}),console.log(this.ques.controls))})}questionForm(){return this.questions.get("question")}createQuestion(t){return this.fb.group({question:t.question,review_type:t.review_type,id:t.id,ans:t.ans,options:new c.Oe([])})}getOptions(t){return this.questionForm().at(t).get("options")}createOption(t){return this.fb.group({key:t})}back(){this.location.back()}showItem(t){return t.controls.question.value}showOptions(t){return t.controls.key.value}getType(t){return t.controls.review_type.value}getControlId(t){return console.log(t.controls.id.value),t.controls.id.value}onSubmit(){var t=[];for(let d=0;d<this.questions.value.question.length;d++)t.push({reviewTitle:this.questions.value.question[d].question,reviewDesc:this.questions.value.question[d].ans,rating:this.questions.value.question[d].ans,reviewkey:this.questions.value.question[d].review_type,question_id:this.questions.value.question[d].id});var o=new Date,i=new FormData,g=localStorage.getItem("cc_selected_group_id"),l=localStorage.getItem("ca_user_id"),A=localStorage.getItem("ca_auth_key");i.append("traveller_id",`${l}`),i.append("nonce",`${A}`),i.append("booking_id",`${g}`),i.append("date",`${o}`),i.append("reviewID",`${this.review_id}`),i.append("reviews",JSON.stringify(t)),this.globalService.presentLoading2(),this.apiService.saveFeedback(i).subscribe(d=>{"success"===d.status&&(this.form_submitted=!1)})}updateFeedback(){this.form_submitted=!this.form_submitted}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.Ye),e.Y36(b.U),e.Y36(c.qu),e.Y36(f.s))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-feedback"]],decls:11,vars:3,consts:[["collapse","fade"],["slot","start",3,"click"],["name","chevron-back-outline",1,"back-arrow"],[3,"fullscreen"],[1,"menu-page"],[4,"ngIf"],["style","text-align: center;",4,"ngIf"],[3,"formGroup","ngSubmit"],["formArrayName","question",4,"ngFor","ngForOf"],[2,"text-align","center"],["type","submit"],["formArrayName","question"],[3,"formGroupName"],[2,"margin-bottom","10px"],["label","Regular textarea","formControlName","ans","rows","5","placeholder","Type something here"],["aria-label","Range with ticks","formControlName","ans",3,"ticks","snaps","min","max"],[2,"text-align","right"],["size","0.7"],["size","2.22"],["formControlName","ans"],[4,"ngFor","ngForOf"],[1,"radio_div"],[3,"value"],[2,"padding","10px","text-align","center"],["src","assets/images/feedback-msg.png","width","100%"],["ion-button","","type","button",3,"click"],["src","assets/images/no-feedback.png","width","100%"]],template:function(t,o){1&t&&(e.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),e.NdJ("click",function(){return o.back()}),e._UZ(3,"ion-icon",2),e.qZA(),e._UZ(4,"app-header"),e.qZA()(),e.TgZ(5,"ion-content",3)(6,"div",4)(7,"label"),e._uU(8,"Feedback"),e.qZA()(),e.YNc(9,Z,4,3,"div",5),e.YNc(10,w,3,0,"div",6),e.qZA()),2&t&&(e.xp6(5),e.Q6J("fullscreen",!0),e.xp6(4),e.Q6J("ngIf",o.feedback&&!o.isAPILoading),e.xp6(1),e.Q6J("ngIf",!o.feedback&&!o.isAPILoading))},dependencies:[u.sg,u.O5,c._Y,c.JJ,c.JL,a.YG,a.Sm,a.PM,a.FN,a.wI,a.W2,a.Gu,a.gu,a.Ie,a.Q$,a.B7,a.se,a.I_,a.Nd,a.g2,a.sr,a.U5,a.QI,a.j9,m.G,c.sg,c.u,c.x0,c.CE],styles:[".menu-page[_ngcontent-%COMP%]{padding:10px}.menu-page[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#000;font-size:25px}ion-item[_ngcontent-%COMP%]{border:1px solid #ddd;--background: #f4f4f4}ion-range[_ngcontent-%COMP%]{margin-left:-8px}ion-radio[_ngcontent-%COMP%]{margin-bottom:12px;margin-right:20px;align-items:center}.radio_div[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px}ion-radio[_ngcontent-%COMP%]::part(container){width:30px;height:30px;border-radius:8px;border:2px solid #ddd}ion-radio[_ngcontent-%COMP%]::part(mark){background:none;transition:none;transform:none;border-radius:0}ion-radio.radio-checked[_ngcontent-%COMP%]::part(container){background:var(--bgcolor);border-color:transparent}ion-radio.radio-checked[_ngcontent-%COMP%]::part(mark){width:6px;height:10px;border-width:0px 2px 2px 0px;border-style:solid;border-color:#fff;transform:rotate(45deg)}ion-range[_ngcontent-%COMP%]::part(tick){height:12px;width:12px;top:16px;border-radius:50%;z-index:2;border:1px var(--bgcolor) solid;background:#f4f4f4}ion-range[_ngcontent-%COMP%]::part(tick-active){height:12px;width:12px;top:16px;border-radius:50%;z-index:2;border:1px var(--bgcolor) solid;background:var(--bgcolor)}ion-range[_ngcontent-%COMP%]::part(bar){border:1px var(--bgcolor) solid;background-color:#f4f4f4;z-index:0}ion-range[_ngcontent-%COMP%]::part(knob){border:1px var(--bgcolor) solid;z-index:22;margin-left:5px;background:var(--bgcolor)}ion-range[_ngcontent-%COMP%]::part(bar-active){border:1px var(--bgcolor) solid;background:var(--bgcolor)}ion-label[_ngcontent-%COMP%]{font-size:20px}"]}),n})()}];let y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[_.Bz.forChild(O),_.Bz]}),n})();var T=s(4546);let I=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[u.ez,c.u5,a.Pc,y,T.O,c.UX]}),n})()}}]);