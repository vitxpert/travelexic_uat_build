"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9103],{9103:(G,m,a)=>{a.r(m),a.d(m,{CustomFormPageModule:()=>w});var u=a(6895),d=a(4006),i=a(8058),g=a(3317),_=a(655),p=a(5838),t=a(8256),f=a(1228),h=a(1270),b=a(1692),x=a(3646);function C(n,e){1&n&&(t.TgZ(0,"p"),t._uU(1,"No record found"),t.qZA())}function v(n,e){1&n&&(t.TgZ(0,"ion-button",19),t._uU(1,"Paid"),t.qZA())}function T(n,e){1&n&&(t.TgZ(0,"ion-button",20),t._uU(1,"Unpaid"),t.qZA())}function Z(n,e){if(1&n&&(t.TgZ(0,"ion-button",21),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.form_status)}}function P(n,e){if(1&n&&(t.TgZ(0,"ion-button",22),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.form_status)}}function F(n,e){if(1&n&&(t.TgZ(0,"ion-button",19),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.form_status)}}function O(n,e){1&n&&(t.TgZ(0,"ion-button",19),t._uU(1,"Paid"),t.qZA())}function M(n,e){1&n&&(t.TgZ(0,"ion-button",20),t._uU(1,"Unpaid"),t.qZA())}function y(n,e){if(1&n&&(t.TgZ(0,"ion-button",21),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.form_status)}}function A(n,e){if(1&n&&(t.TgZ(0,"ion-button",22),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.form_status)}}function S(n,e){if(1&n&&(t.TgZ(0,"ion-button",19),t._uU(1),t.qZA()),2&n){const o=t.oxw().$implicit;t.xp6(1),t.Oqu(o.form_status)}}function U(n,e){if(1&n){const o=t.EpF();t.ynx(0),t.TgZ(1,"tr",23)(2,"td",12),t._uU(3),t.qZA(),t.TgZ(4,"td",12),t._uU(5),t.qZA(),t.TgZ(6,"td",12),t.YNc(7,O,2,0,"ion-button",13),t.YNc(8,M,2,0,"ion-button",14),t.qZA(),t.TgZ(9,"td",12),t.YNc(10,y,2,1,"ion-button",15),t.YNc(11,A,2,1,"ion-button",16),t.YNc(12,S,2,1,"ion-button",13),t.qZA(),t.TgZ(13,"td",12)(14,"ion-button",17),t.NdJ("click",function(){const r=t.CHM(o).$implicit,c=t.oxw(2);return t.KtG(c.openFillForm(r))}),t._uU(15),t.qZA()()(),t.BQk()}if(2&n){const o=e.$implicit;t.xp6(3),t.hij(" ",null==o?null:o.name," "),t.xp6(2),t.hij(" ",null==o?null:o.relation," "),t.xp6(2),t.Q6J("ngIf","1"==(null==o?null:o.payment_status)),t.xp6(1),t.Q6J("ngIf","1"!=(null==o?null:o.payment_status)),t.xp6(2),t.Q6J("ngIf","processing"==o.form_status),t.xp6(1),t.Q6J("ngIf","started"==o.form_status),t.xp6(1),t.Q6J("ngIf","completed"==o.form_status),t.xp6(3),t.Oqu("started"==o.form_status?"Fill Form":"Update Form")}}const k=function(){return["first0"]};function q(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"ion-accordion-group",4)(1,"ion-accordion",5)(2,"ion-item",6)(3,"ion-label"),t._uU(4),t.qZA()(),t.TgZ(5,"div",7)(6,"table",8)(7,"thead",9)(8,"tr",10)(9,"th",11),t._uU(10,"Name"),t.qZA(),t.TgZ(11,"th",11),t._uU(12,"Secondary Relation"),t.qZA(),t.TgZ(13,"th",11),t._uU(14,"Payment Status"),t.qZA(),t.TgZ(15,"th",11),t._uU(16,"Status"),t.qZA(),t.TgZ(17,"th",11),t._uU(18,"Action"),t.qZA()()(),t.TgZ(19,"tbody",9)(20,"tr",10)(21,"td",12),t._uU(22),t.qZA(),t.TgZ(23,"td",12),t._uU(24,"-"),t.qZA(),t.TgZ(25,"td",12),t.YNc(26,v,2,0,"ion-button",13),t.YNc(27,T,2,0,"ion-button",14),t.qZA(),t.TgZ(28,"td",12),t.YNc(29,Z,2,1,"ion-button",15),t.YNc(30,P,2,1,"ion-button",16),t.YNc(31,F,2,1,"ion-button",13),t.qZA(),t.TgZ(32,"td",12)(33,"ion-button",17),t.NdJ("click",function(){const r=t.CHM(o).$implicit,c=t.oxw();return t.KtG(c.openFillForm(r))}),t._uU(34),t.qZA()()(),t.YNc(35,U,16,8,"ng-container",18),t.qZA()()()()()}if(2&n){const o=e.$implicit,l=e.index;t.Q6J("value",t.DdM(11,k)),t.xp6(1),t.Q6J("value","first"+l),t.xp6(3),t.Oqu(null==o||null==o.group_id?null:o.group_id.group_name),t.xp6(18),t.Oqu(null==o?null:o.name),t.xp6(4),t.Q6J("ngIf","1"==(null==o?null:o.payment_status)),t.xp6(1),t.Q6J("ngIf","1"!=(null==o?null:o.payment_status)),t.xp6(2),t.Q6J("ngIf","processing"==o.form_status),t.xp6(1),t.Q6J("ngIf","started"==o.form_status),t.xp6(1),t.Q6J("ngIf","completed"==o.form_status),t.xp6(3),t.Oqu("started"==o.form_status?"Fill Form":"Update Form"),t.xp6(1),t.Q6J("ngForOf",o.booking_children)}}function J(n,e){if(1&n&&(t.ynx(0),t.TgZ(1,"ion-item")(2,"ion-label"),t._uU(3),t.qZA(),t._UZ(4,"ion-radio",5),t.qZA(),t.BQk()),2&n){const o=e.$implicit;t.xp6(3),t.Oqu(o.travel_date),t.xp6(1),t.Q6J("value",o.id)}}function Q(n,e){if(1&n){const o=t.EpF();t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),t._uU(3,"Select Travel Date"),t.qZA(),t.TgZ(4,"ion-buttons",24)(5,"ion-button",25),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.setOpen(!1))}),t._uU(6,"Close"),t.qZA()()()(),t.TgZ(7,"ion-content",26)(8,"ion-radio-group",27),t.NdJ("ionChange",function(s){t.CHM(o);const r=t.oxw();return t.KtG(r.checkboxChange(s))})("ngModelChange",function(s){t.CHM(o);const r=t.oxw();return t.KtG(r.selectedTravelDate=s)}),t.YNc(9,J,5,2,"ng-container",18),t.qZA(),t.TgZ(10,"ion-button",28),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.doSubmit())}),t._uU(11,"Submit"),t.qZA()()}if(2&n){const o=t.oxw();t.xp6(8),t.Q6J("ngModel",o.selectedTravelDate),t.xp6(1),t.Q6J("ngForOf",o.formSelected.available_travel_dates),t.xp6(1),t.Q6J("disabled",o.setDateButtonDisabled)}}const N=[{path:"",component:(()=>{class n{constructor(o,l,s,r,c,D,$,B){this.authService=o,this.alertController=l,this.formApiService=s,this.location=r,this.router=c,this.navCtrl=D,this.modalCtrl=$,this.globalService=B,this.accessToken="",this.accToken="",this.isModalOpen=!1,this.loading=!1,this.setDateButtonDisabled=!1}ngOnInit(){this.getDeviceInfo(),this.getForms(),this.accToken=localStorage.getItem("accessToken")||"",this.globalService.agentLogoEvent.next(""),this.globalService.accessTokenEvent.subscribe(o=>{null!=o&&(this.data=[],this.getForms())}),this.globalService.completeFormEvent.subscribe(o=>{null!==o&&this.getForms()})}getForms(){this.loading=!0,this.formApiService.getForms().subscribe(o=>{this.loading=!1,o.success?(this.accToken||(this.accToken=o?.jwtAccessToken,localStorage.setItem("accessToken",o?.jwtAccessToken)),this.data=o?.data):"expired"==o.message||this.globalService.showError(o.message)})}getDeviceInfo(){return(0,_.mG)(this,void 0,void 0,function*(){const o=yield p.A.getLanguageCode();console.log(o),localStorage.getItem("ca_auth_key")})}openFillForm(o){return(0,_.mG)(this,void 0,void 0,function*(){this.formSelected=o,"primary"==o?.type&&0==o?.is_question_asked&&"completed"!=o?.form_status&&"regular"==o?.added_from&&Number(o.total_corporate_paid_nominations_allowed)>0?yield(yield this.alertController.create({header:"Question",message:"Are you travelling in this group?",mode:"ios",buttons:[{text:"Yes",handler:()=>{this.askQuestion1(this.formSelected)}},{text:"No",role:"no",cssClass:"secondary",handler:s=>{this.secondaryMember(),this.navCtrl.pop()}},{text:"Close",role:"cancel",cssClass:"secondary",handler:s=>{this.navCtrl.pop()}}]})).present():this.askQuestion1(this.formSelected)})}askQuestion1(o){null==o.travel_date&&o.available_travel_dates.length>0?(this.selectedTravelDate=this.formSelected.available_travel_dates[0].id,this.setOpen(!0)):this.router.navigate(["/app/home/custom-form/welcome-form-page/"+o?.id])}secondaryMember(){this.formApiService.addOnlySecondary(this.formSelected.id).subscribe(o=>{o.success&&this.askQuestion1(this.formSelected)})}back(){this.location.back()}setOpen(o){this.isModalOpen=o}checkboxChange(o){const{value:s}=o.detail;this.selectedTravelDate=s,console.log(this.selectedTravelDate)}doSubmit(){const o={traveller_form_id:this.formSelected.id,date_inventory_id:this.selectedTravelDate};this.setDateButtonDisabled=!0,this.formApiService.saveTravelDate(o).subscribe(l=>{var s;this.modalCtrl.dismiss(),l.success&&(this.setOpen(!1),this.router.navigate(["/app/home/custom-form/welcome-form-page/"+(null===(s=this.formSelected)||void 0===s?void 0:s.id)]))})}}return n.\u0275fac=function(o){return new(o||n)(t.Y36(f.e),t.Y36(i.Br),t.Y36(h.$),t.Y36(u.Ye),t.Y36(g.F0),t.Y36(i.SH),t.Y36(i.IN),t.Y36(b.U))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-custom-form"]],decls:10,vars:3,consts:[[1,"box-form"],[4,"ngIf"],["style","margin-top:15px;",3,"value",4,"ngFor","ngForOf"],["id","datemodal",3,"isOpen"],[2,"margin-top","15px",3,"value"],[3,"value"],["slot","header","color","primary"],["slot","content",1,"content-body",2,"overflow-x","auto"],["role","table",1,"table"],["role","rowgroup"],["role","row"],["role","columnheader"],["role","cell"],["ion-button","","class","btn-green-outline",4,"ngIf"],["ion-button","","class","btn-red-outline",4,"ngIf"],["ion-button","","class","btn-warning-outline",4,"ngIf"],["ion-button","","class","btn-primary-outline",4,"ngIf"],["ion-button","",1,"primary-btn",2,"margin-top","10px",3,"click"],[4,"ngFor","ngForOf"],["ion-button","",1,"btn-green-outline"],["ion-button","",1,"btn-red-outline"],["ion-button","",1,"btn-warning-outline"],["ion-button","",1,"btn-primary-outline"],["role","row",2,"margin-top","10px","border-top","1px dashed #eee"],["slot","end"],[3,"click"],[1,"ion-padding","my-popup"],["value","end",3,"ngModel","ionChange","ngModelChange"],["ion-button","","size","full",2,"margin-top","10px",3,"disabled","click"]],template:function(o,l){1&o&&(t.TgZ(0,"ion-content")(1,"div",0),t._UZ(2,"app-header"),t.TgZ(3,"ion-card"),t._UZ(4,"ion-card-header"),t.TgZ(5,"ion-card-content"),t.YNc(6,C,2,0,"p",1),t.YNc(7,q,36,12,"ion-accordion-group",2),t.qZA()()()(),t.TgZ(8,"ion-modal",3),t.YNc(9,Q,12,3,"ng-template"),t.qZA()),2&o&&(t.xp6(6),t.Q6J("ngIf",0==(null==l.data?null:l.data.length)&&0==l.loading),t.xp6(1),t.Q6J("ngForOf",l.data),t.xp6(1),t.Q6J("isOpen",l.isModalOpen))},dependencies:[u.sg,u.O5,d.JJ,d.On,i.We,i.eh,i.YG,i.Sm,i.PM,i.FN,i.Zi,i.W2,i.Gu,i.Ie,i.Q$,i.B7,i.se,i.wd,i.sr,i.ki,i.U5,i.QI,x.G],styles:['.box-form[_ngcontent-%COMP%]{overflow:scroll;background:var(--bgcolor);padding:15px;height:100%}ion-accordion-group[_ngcontent-%COMP%], ion-accordion[_ngcontent-%COMP%]{border-radius:10px;border:.3px solid}.content-body[_ngcontent-%COMP%]{padding:20px;font-size:18px}.table[_ngcontent-%COMP%]{width:100%}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:1px #ddd solid}@media only screen and (max-width: 760px),(min-device-width: 768px) and (max-device-width: 1024px){table[_ngcontent-%COMP%], thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%], th[_ngcontent-%COMP%], td[_ngcontent-%COMP%], tr[_ngcontent-%COMP%]{display:block}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:left}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{position:absolute;top:-9999px;left:-9999px}tr[_ngcontent-%COMP%]{margin:0 0 1rem}tr[_ngcontent-%COMP%]:nth-child(odd){background:#fff}td[_ngcontent-%COMP%]{border:none;border-bottom:1px solid #fff;position:relative;padding-left:50%;min-height:50px}td[_ngcontent-%COMP%]:before{position:absolute;top:0;left:6px;width:45%;padding-right:10px;line-height:20px}td[_ngcontent-%COMP%]:nth-of-type(1):before{content:"Name"}td[_ngcontent-%COMP%]:nth-of-type(2):before{content:"Secondary Relation"}td[_ngcontent-%COMP%]:nth-of-type(3):before{content:"Payment Status"}td[_ngcontent-%COMP%]:nth-of-type(4):before{content:"Status"}td[_ngcontent-%COMP%]:nth-of-type(5):before{content:"Action"}}']}),n})()},{path:"fill-form/:id/:step/:lang",loadChildren:()=>a.e(8382).then(a.bind(a,8382)).then(n=>n.FillFormPageModule)},{path:"welcome-form-page/:id",loadChildren:()=>a.e(8191).then(a.bind(a,8191)).then(n=>n.WelcomeFormPagePageModule)}];let Y=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[g.Bz.forChild(N),g.Bz]}),n})();var I=a(4546);let w=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[u.ez,d.u5,i.Pc,Y,I.O]}),n})()}}]);