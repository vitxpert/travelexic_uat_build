"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[943],{943:(en,p,a)=>{a.r(p),a.d(p,{TravelDocumentsPageModule:()=>on});var s=a(6895),f=a(4006),_=a(8058),g=a(3317),u=a(655),h=a(2340),l=a(9812),n=a(8256),T=a(5146),v=a(1692),x=a(3646),Z=a(6078);const D=["segment"];function w(e,i){if(1&e){const o=n.EpF();n.TgZ(0,"ion-button",19),n.NdJ("click",function(){n.CHM(o);const c=n.oxw();return n.KtG(c.tourCompleted())}),n._uU(1," Complete "),n.qZA()}}function P(e,i){1&e&&(n.TgZ(0,"ion-button",20),n._UZ(1,"ion-icon",21),n.qZA())}function y(e,i){1&e&&(n.TgZ(0,"ion-button",20),n._UZ(1,"ion-icon",22),n.qZA())}function k(e,i){1&e&&n._uU(0),2&e&&n.AsE(" ",i.step,"/",i.total," ")}function b(e,i){if(1&e&&(n.ynx(0),n._UZ(1,"app-flight",28),n.BQk()),2&e){const o=n.oxw().$implicit;n.xp6(1),n.Q6J("flightData",o)("completeURL","yes")}}function Q(e,i){if(1&e&&(n.ynx(0),n.YNc(1,b,2,2,"ng-container",18),n.BQk()),2&e){const o=i.$implicit;n.xp6(1),n.Q6J("ngIf",null==o?null:o.arr_code)}}function A(e,i){if(1&e&&(n.ynx(0),n.YNc(1,Q,2,1,"ng-container",27),n.BQk()),2&e){const o=n.oxw().$implicit;n.xp6(1),n.Q6J("ngForOf",o.documents.flight)}}function J(e,i){1&e&&(n.ynx(0),n._UZ(1,"img",29),n.BQk())}const S=function(){return["record0"]};function F(e,i){if(1&e&&(n.TgZ(0,"ion-accordion-group",24)(1,"ion-accordion",24)(2,"ion-item",25)(3,"ion-label"),n._uU(4),n.qZA(),n.TgZ(5,"p"),n._uU(6),n.qZA()(),n.TgZ(7,"div",26),n.YNc(8,A,2,1,"ng-container",18),n.YNc(9,J,2,0,"ng-container",18),n.qZA()()()),2&e){const o=i.$implicit,t=i.index,c=n.oxw(2);n.Q6J("value",n.DdM(6,S)),n.xp6(1),n.Q6J("value","record"+t),n.xp6(3),n.Oqu(o.name),n.xp6(2),n.Oqu(o.type),n.xp6(2),n.Q6J("ngIf",!c.checkFlightRecordsEmpty(o.documents.flight)),n.xp6(1),n.Q6J("ngIf",c.checkFlightRecordsEmpty(o.documents.flight))}}function N(e,i){if(1&e&&(n.ynx(0),n.YNc(1,F,10,7,"ion-accordion-group",23),n.BQk()),2&e){const o=n.oxw();n.xp6(1),n.Q6J("ngForOf",o.records)}}function U(e,i){if(1&e){const o=n.EpF();n.TgZ(0,"ion-row",35)(1,"ion-col",31),n._uU(2,"Passport"),n.qZA(),n.TgZ(3,"ion-col",32),n._uU(4,"Passport"),n.qZA(),n.TgZ(5,"ion-col",33)(6,"ion-icon",36),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit,r=n.oxw(4);return n.KtG(r.downloadFile(c.pdf))}),n.qZA()()()}}function Y(e,i){if(1&e&&(n.ynx(0),n.YNc(1,U,7,0,"ion-row",34),n.BQk()),2&e){const o=i.$implicit;n.xp6(1),n.Q6J("ngIf",""!==o.pdf)}}function I(e,i){if(1&e){const o=n.EpF();n.TgZ(0,"ion-row",35)(1,"ion-col",31),n._uU(2,"Visa"),n.qZA(),n.TgZ(3,"ion-col",32),n._uU(4,"E-Visa"),n.qZA(),n.TgZ(5,"ion-col",33)(6,"ion-icon",36),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit,r=n.oxw(4);return n.KtG(r.downloadFile(c.url))}),n.qZA()()()}}function O(e,i){if(1&e&&(n.ynx(0),n.YNc(1,I,7,0,"ion-row",34),n.BQk()),2&e){const o=i.$implicit;n.xp6(1),n.Q6J("ngIf",""!==o.url)}}function q(e,i){if(1&e){const o=n.EpF();n.TgZ(0,"ion-row",35)(1,"ion-col",31),n._uU(2,"Insurance"),n.qZA(),n.TgZ(3,"ion-col",32),n._uU(4,"Documents"),n.qZA(),n.TgZ(5,"ion-col",33)(6,"ion-icon",36),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit,r=n.oxw(4);return n.KtG(r.downloadFile(c.url))}),n.qZA()()()}}function E(e,i){if(1&e&&(n.ynx(0),n.YNc(1,q,7,0,"ion-row",34),n.BQk()),2&e){const o=i.$implicit;n.xp6(1),n.Q6J("ngIf",""!==o.url)}}function R(e,i){if(1&e){const o=n.EpF();n.TgZ(0,"ion-row",35)(1,"ion-col",31),n._uU(2,"Voucher"),n.qZA(),n.TgZ(3,"ion-col",32),n._uU(4,"Documents"),n.qZA(),n.TgZ(5,"ion-col",33)(6,"ion-icon",36),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit,r=n.oxw(4);return n.KtG(r.downloadFile(c.url))}),n.qZA()()()}}function M(e,i){if(1&e&&(n.ynx(0),n.YNc(1,R,7,0,"ion-row",34),n.BQk()),2&e){const o=i.$implicit;n.xp6(1),n.Q6J("ngIf",""!==o.url)}}function B(e,i){if(1&e){const o=n.EpF();n.TgZ(0,"ion-row",35)(1,"ion-col",31),n._uU(2,"PhotoId"),n.qZA(),n.TgZ(3,"ion-col",32),n._uU(4,"Documents"),n.qZA(),n.TgZ(5,"ion-col",33)(6,"ion-icon",36),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit,r=n.oxw(4);return n.KtG(r.downloadFile(c.url))}),n.qZA()()()}}function C(e,i){if(1&e&&(n.ynx(0),n.YNc(1,B,7,0,"ion-row",34),n.BQk()),2&e){const o=i.$implicit;n.xp6(1),n.Q6J("ngIf",""!==o.url)}}function $(e,i){if(1&e){const o=n.EpF();n.TgZ(0,"ion-row",35)(1,"ion-col",31),n._uU(2,"Others"),n.qZA(),n.TgZ(3,"ion-col",32),n._uU(4,"Documents"),n.qZA(),n.TgZ(5,"ion-col",33)(6,"ion-icon",36),n.NdJ("click",function(){n.CHM(o);const c=n.oxw().$implicit,r=n.oxw(4);return n.KtG(r.downloadFile(c.url))}),n.qZA()()()}}function G(e,i){if(1&e&&(n.ynx(0),n.YNc(1,$,7,0,"ion-row",34),n.BQk()),2&e){const o=i.$implicit;n.xp6(1),n.Q6J("ngIf",""!==o.url)}}function z(e,i){if(1&e&&(n.TgZ(0,"ion-grid")(1,"ion-row",30)(2,"ion-col",31),n._uU(3,"Name"),n.qZA(),n.TgZ(4,"ion-col",32),n._uU(5,"Document Type"),n.qZA(),n.TgZ(6,"ion-col",33),n._uU(7,"Download"),n.qZA()(),n.ynx(8),n.YNc(9,Y,2,1,"ng-container",27),n.YNc(10,O,2,1,"ng-container",27),n.YNc(11,E,2,1,"ng-container",27),n.YNc(12,M,2,1,"ng-container",27),n.YNc(13,C,2,1,"ng-container",27),n.YNc(14,G,2,1,"ng-container",27),n.BQk(),n.qZA()),2&e){const o=n.oxw().$implicit,t=n.oxw(2);n.xp6(9),n.Q6J("ngForOf",t.getRecords(o.name,"passport")),n.xp6(1),n.Q6J("ngForOf",t.getRecords(o.name,"visa")),n.xp6(1),n.Q6J("ngForOf",t.getRecords(o.name,"insurance")),n.xp6(1),n.Q6J("ngForOf",t.getRecords(o.name,"voucher")),n.xp6(1),n.Q6J("ngForOf",t.getRecords(o.name,"photoId")),n.xp6(1),n.Q6J("ngForOf",t.getRecords(o.name,"others"))}}function j(e,i){1&e&&(n.ynx(0),n._UZ(1,"img",29),n.BQk())}const H=function(){return["first0"]};function K(e,i){if(1&e&&(n.TgZ(0,"ion-accordion-group",24)(1,"ion-accordion",24)(2,"ion-item",25)(3,"ion-label"),n._uU(4),n.qZA(),n.TgZ(5,"p"),n._uU(6),n.qZA()(),n.TgZ(7,"div",26),n.YNc(8,z,15,6,"ion-grid",18),n.YNc(9,j,2,0,"ng-container",18),n.qZA()()()),2&e){const o=i.$implicit,t=i.index,c=n.oxw(2);n.Q6J("value",n.DdM(6,H)),n.xp6(1),n.Q6J("value","first"+t),n.xp6(3),n.Oqu(o.name),n.xp6(2),n.Oqu(o.type),n.xp6(2),n.Q6J("ngIf",!c.checkRecordsEmpty(o.name)),n.xp6(1),n.Q6J("ngIf",c.checkRecordsEmpty(o.name))}}function W(e,i){if(1&e&&(n.ynx(0),n.YNc(1,K,10,7,"ion-accordion-group",23),n.BQk()),2&e){const o=n.oxw();n.xp6(1),n.Q6J("ngForOf",o.records)}}const V=[{path:"",component:(()=>{class e{constructor(o,t,c,r,m,d){this.apiService=o,this.navCtrl=t,this.location=c,this.globalService=r,this.activateRoute=m,this.joyrideService=d,this.records=[],this.activeSegment="flight_tickets",this.data=[],this.tourDocumentsEnabled=!1,this.fetchDocuments(),this.loadData()}ngOnInit(){this.globalService.documentUnseenEvent.next("no"),this.activeSegment=this.activateRoute.snapshot.params.type,setTimeout(()=>{this.segment.value=this.activeSegment},200),this.globalService.documentSwitchEvent.subscribe(t=>{null!==t&&"other_documents"===t&&setTimeout(()=>{this.activeSegment=t,this.segment.value=t},200)}),this.globalService.groupSwitchEvent.subscribe(t=>{null!==t&&this.fetchDocuments()}),this.globalService.documentSwitchEvent2.subscribe(t=>{null!==t&&this.fetchDocuments()}),"yes"!==(localStorage.getItem("tour_documents_enabled")||"")&&(this.tourDocumentsEnabled=!0,setTimeout(()=>{this.startTour4()},1e3))}startTour4(){this.joyrideService.startTour({steps:["step12","step13"]})}tourCompleted(){this.tourDocumentsEnabled=!1,localStorage.setItem("tour_documents_enabled","yes")}fetchDocuments(){this.actionGroup=localStorage.getItem("cc_selected_group_id"),this.ca_auth_key=localStorage.getItem("ca_auth_key"),this.ca_user_id=localStorage.getItem("ca_user_id");const o=new FormData;o.append("traveller_id",this.ca_user_id),o.append("booking_id",this.actionGroup),o.append("nonce",this.ca_auth_key),this.apiService.getDocuments(o).subscribe(t=>{!0===t.status&&this.initializeData(t.data)})}initializeData(o){console.log(o),this.records=[];for(const[t,c]of Object.entries(o))console.log(c),this.records.push(Object.assign({name:t},c));console.log(this.records)}getRecords(o,t){let c=[];return this.records.forEach(r=>{r.name===o&&(c=r.documents[t])}),c}checkRecordsEmpty(o){let t=!1;return this.records.forEach(r=>{r.name===o&&0===r.documents.insurance.length&&0===r.documents.others.length&&0===r.documents.passport.length&&0===r.documents.photoId.length&&0===r.documents.visa.length&&0===r.documents.voucher.length&&(t=!0)}),t}checkFlightRecordsEmpty(o){let t=!0;return o.forEach(c=>{c?.arr_code&&(t=!1)}),t}changeSegment(o){this.activeSegment=o.target.value}downloadFile(o){let t=0;this.data.forEach(c=>(0,u.mG)(this,void 0,void 0,function*(){c.url==o&&(this.globalService.presentToast("file opening..."),this.globalService.openFile(c.filepath),t=1)})),0==t&&(0==o.indexOf("http")||0==o.indexOf("HTTP")?this.globalService.downloadFile(o):this.globalService.downloadFile(h.N.baseUrl+o))}back(){this.location.back()}doRefresh(o){this.fetchDocuments(),o.target.complete()}loadData(){return(0,u.mG)(this,void 0,void 0,function*(){this.data=yield this.globalService.loadSaved()})}openFile(o){console.log(this.data),this.data.forEach(t=>(0,u.mG)(this,void 0,void 0,function*(){t.url==o&&this.globalService.openFile(t.filepath)}))}}return e.\u0275fac=function(o){return new(o||e)(n.Y36(T.s),n.Y36(_.SH),n.Y36(s.Ye),n.Y36(v.U),n.Y36(g.gz),n.Y36(l.p9))},e.\u0275cmp=n.Xpm({type:e,selectors:[["app-travel-documents"]],viewQuery:function(o,t){if(1&o&&n.Gf(D,5),2&o){let c;n.iGM(c=n.CRH())&&(t.segment=c.first)}},features:[n._Bn([l.p9])],decls:33,vars:6,consts:[["collapse","fade"],["slot","start",3,"click"],["name","chevron-back-outline",1,"back-arrow"],["slot","end",3,"click"],["name","information-circle-outline",2,"font-size","25px","margin-right","10px"],["slot","fixed",3,"ionRefresh"],["pullingIcon","chevron-down-circle-outline","pullingText","","refreshingSpinner","circles","refreshingText",""],[1,"menu-page"],[2,"padding","10px"],["doneButton2",""],["prevButton2",""],["nextButton2",""],["counter2",""],[1,"notice-container"],["mode","ios","scrollable","","value","flight_tickets",3,"ionChange"],["segment",""],["value","flight_tickets","joyrideStep","step12","text","To show Flight Tickets",3,"doneTemplate","prevTemplate","nextTemplate","counterTemplate"],["value","other_documents","joyrideStep","step13","text","To show Visa, Passport other documents"],[4,"ngIf"],["size","small",3,"click"],["size","small"],["name","arrow-back-outline"],["name","arrow-forward-outline"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["slot","header","color","primary"],["slot","content"],[4,"ngFor","ngForOf"],[3,"flightData","completeURL"],["src","assets/images/no-docs.png","width","100%"],[1,"table-header"],["size","4"],["size","5"],["size","3"],["class","table-content",4,"ngIf"],[1,"table-content"],["name","cloud-download-outline",2,"font-size","20px",3,"click"]],template:function(o,t){if(1&o&&(n.TgZ(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),n.NdJ("click",function(){return t.back()}),n._UZ(3,"ion-icon",2),n.qZA(),n._UZ(4,"app-header"),n.TgZ(5,"ion-buttons",3),n.NdJ("click",function(){return t.startTour4()}),n._UZ(6,"ion-icon",4),n.qZA()()(),n.TgZ(7,"ion-content")(8,"ion-refresher",5),n.NdJ("ionRefresh",function(r){return t.doRefresh(r)}),n._UZ(9,"ion-refresher-content",6),n.qZA(),n.TgZ(10,"div",7)(11,"h5",8),n._uU(12,"Travel Documents"),n.qZA()(),n.YNc(13,w,2,0,"ng-template",null,9,n.W1O),n.YNc(15,P,2,0,"ng-template",null,10,n.W1O),n.YNc(17,y,2,0,"ng-template",null,11,n.W1O),n.YNc(19,k,1,2,"ng-template",null,12,n.W1O),n.TgZ(21,"div",13)(22,"ion-segment",14,15),n.NdJ("ionChange",function(r){return t.changeSegment(r)}),n.TgZ(24,"ion-segment-button",16)(25,"ion-label"),n._uU(26,"Flight Tickets "),n.qZA()(),n.TgZ(27,"ion-segment-button",17)(28,"ion-label"),n._uU(29,"Other Documents"),n.qZA()()(),n.TgZ(30,"div",8),n.YNc(31,N,2,1,"ng-container",18),n.YNc(32,W,2,1,"ng-container",18),n.qZA()()()),2&o){const c=n.MAs(14),r=n.MAs(16),m=n.MAs(18),d=n.MAs(20);n.xp6(24),n.Q6J("doneTemplate",c)("prevTemplate",r)("nextTemplate",m)("counterTemplate",d),n.xp6(7),n.Q6J("ngIf","flight_tickets"===t.activeSegment),n.xp6(1),n.Q6J("ngIf","other_documents"===t.activeSegment)}},dependencies:[s.sg,s.O5,_.We,_.eh,_.YG,_.Sm,_.wI,_.W2,_.jY,_.Gu,_.gu,_.Ie,_.Q$,_.nJ,_.Wo,_.Nd,_.cJ,_.GO,_.sr,_.QI,x.G,Z.N,l.ym],styles:[".table-header[_ngcontent-%COMP%]{background:var(--ion-color-medium);color:#fff;padding:10px}.table-content[_ngcontent-%COMP%]{border:1px #f4f4f4 solid;padding:10px}"]}),e})()}];let L=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[g.Bz.forChild(V),g.Bz]}),e})();var X=a(4546),nn=a(7990);let on=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=n.oAB({type:e}),e.\u0275inj=n.cJS({imports:[s.ez,f.u5,_.Pc,L,X.O,nn.z,l.Mc.forChild()]}),e})()}}]);